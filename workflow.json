{
  "nodes": [
    {
      "parameters": {
        "options": {
          "systemMessage": "=أنت وكيل ذكي اسمه \"Ministry Bot\"، مهمتك هي الإجابة عن الأسئلة المتعلقة بالقوانين والمراسيم التي تنظّم الوزارات اللبنانية.  \nلديك وصول إلى مخزن متجهي (Pinecone) يحتوي على نصوص من القوانين والمراسيم الرسمية مثل وزارة الدفاع، وزارة الإعلام، وزارة التربية، وزارة الخارجية وغيرها.  \n\n◀️ قواعد عامة:\n- عند تلقي سؤال، قم أوّلاً باسترجاع المقاطع الأكثر صلة من المخزن المتجهي (٣ إلى ٥ مقاطع).  \n- لا تخترع معلومات غير موجودة في المستندات. إذا لم تجد الجواب في النصوص، قل: \"المعلومة غير متوفرة في المستندات.\"  \n- أجب دائماً بالعربية الفصحى وبأسلوب رسمي وواضح.  \n- اجعل الجواب قصيراً ودقيقاً، مع ذكر المرسوم أو الجهة إذا كان مذكوراً.  \n- لا تعطِ رأياً شخصياً، اكتفِ بعرض ما ورد في المستندات.  \n\n◀️ طريقة العرض:\n- إذا كان السؤال عن **المهام** → أجب بنقاط مرتّبة.  \n- إذا كان السؤال عن **الهيكلية** → أجب على شكل قائمة.  \n- إذا كان السؤال عن **العلاقات أو التعاون** → أجب بجملة أو فقرتين.  \n\n◀️ أمثلة أسئلة وأجوبة:\n\nس: ما هو المرسوم الذي أعاد تنظيم وزارة الدفاع؟  \nج: صدر مرسوم تنظيمي في ١٨ آذار ١٩٩١ نصّ على إعادة تنظيم وزارة الدفاع وصلاحياتها.  \n\nس: ما هي مهام وزارة الإعلام؟  \nج:  \n- اقتراح وتطبيق السياسة الإعلامية.  \n- متابعة شؤون الإعلام والمطبوعات والإعلان.  \n- إنماء الإذاعة اللبنانية.  \n- الإشراف على المؤسسات السمعية والبصرية.  \n\nس: من هم أعضاء المجلس الاستشاري في وزارة الخارجية؟  \nج: يتألف المجلس الاستشاري في وزارة الخارجية من وزير الخارجية والمغتربين، المدير العام، وممثلين عن الإدارات المركزية والبعثات الدبلوماسية.  \n\nس: ما هي المديريات التابعة لوزارة التربية والتعليم العالي؟  \nج:  \n- مديرية التعليم الثانوي.  \n- مديرية التعليم الابتدائي.  \n- مديرية التعليم المهني والتقني.  \n- مديرية التعليم العالي.  \n\nس: مع أي جهات تتعاون وزارة البيئة؟  \nج: تتعاون وزارة البيئة مع وزارة الزراعة، وزارة الطاقة والمياه، والهيئات الدولية المختصة لحماية البيئة وإدارة الموارد الطبيعية.  \n\nس: ما هي علاقة وزارة الدفاع بوزارة الداخلية؟  \nج: تتعاون وزارة الدفاع مع وزارة الداخلية في مجال الأمن الداخلي، حالات الطوارئ، والتنسيق بين الجيش اللبناني والقوى الأمنية.  \n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        1440,
        0
      ],
      "id": "ae7dc50a-bf55-4633-bab7-37d125f15f44",
      "name": "Internal Data Agent"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.1,
      "position": [
        1200,
        0
      ],
      "id": "cb91c2c0-d45b-431e-9956-8ceed0b73d45",
      "name": "Chat",
      "webhookId": "b9f6eda5-a4ce-4d84-9acf-31a404c04c5f"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        1620,
        420
      ],
      "id": "13f77973-5660-4a59-8b71-93edbe266ac9",
      "name": "Embeddings Model",
      "credentials": {
        "openAiApi": {
          "id": "iN0WKiU3syo7QHmh",
          "name": "OpenAI Account"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        1420,
        220
      ],
      "id": "12d9ba8f-38cd-4541-92fc-614e7902cd9f",
      "name": "4.1-mini",
      "credentials": {
        "openAiApi": {
          "id": "iN0WKiU3syo7QHmh",
          "name": "OpenAI Account"
        }
      }
    },
    {
      "parameters": {
        "url": "=https://www.googleapis.com/drive/v3/files?q='1-aIY_PusN_eBBuk1fTmtedrcoyA28cK5'+in+parents+and+mimeType='application/pdf'&fields=files(id,name)&pageSize=1000",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "googleDriveOAuth2Api",
        "options": {
          "response": {}
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        0,
        0
      ],
      "id": "6718593f-fac6-487b-9cdc-3f0f7e0d9c71",
      "name": "List PDFs (Google Drive API)",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "fDMpcmQ6IwLYyts6",
          "name": "Google Drive Credential"
        }
      }
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "={{ $json.id }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        440,
        0
      ],
      "id": "75a2ba05-09ec-484a-a074-07096b400367",
      "name": "Download PDF",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "fDMpcmQ6IwLYyts6",
          "name": "Google Drive Credential"
        }
      }
    },
    {
      "parameters": {
        "fieldToSplitOut": "files",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        220,
        0
      ],
      "id": "1e77d054-8d23-419d-aece-b2469a78a288",
      "name": "Split Out"
    },
    {
      "parameters": {
        "content": "# Ingestion",
        "height": 660,
        "width": 1120,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -50,
        -100
      ],
      "typeVersion": 1,
      "id": "d28da647-f482-4eb7-b533-dc46b7f7d5f8",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "mode": "insert",
        "pineconeIndex": {
          "__rl": true,
          "value": "ministrybot",
          "mode": "list",
          "cachedResultName": "ministrybot"
        },
        "options": {
          "pineconeNamespace": "data"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        680,
        0
      ],
      "id": "8291c562-ea87-4f57-a58b-a04f67b3a968",
      "name": "Pinecone Vector Store",
      "credentials": {
        "pineconeApi": {
          "id": "4LpKFjhdPCD9VOXK",
          "name": "elhariri2023@gmail.com"
        }
      }
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "Use this for fetching internal data",
        "pineconeIndex": {
          "__rl": true,
          "value": "ministrybot",
          "mode": "list",
          "cachedResultName": "ministrybot"
        },
        "topK": 20,
        "options": {
          "pineconeNamespace": "data"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.3,
      "position": [
        1540,
        220
      ],
      "id": "d1d09e72-a48d-4b20-8e30-6cca652ae6c1",
      "name": "Pinecone Internal Data",
      "credentials": {
        "pineconeApi": {
          "id": "4LpKFjhdPCD9VOXK",
          "name": "elhariri2023@gmail.com"
        }
      }
    },
    {
      "parameters": {
        "dataType": "binary",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1,
      "position": [
        780,
        222.5
      ],
      "id": "3a617fa9-83b1-4de3-90a3-2354d5357195",
      "name": "Default Data Loader"
    },
    {
      "parameters": {
        "chunkSize": 400,
        "chunkOverlap": 80,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
      "typeVersion": 1,
      "position": [
        860,
        420
      ],
      "id": "7729cdb1-468b-4ac7-b045-da7267cb1952",
      "name": "Text Splitter"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        660,
        220
      ],
      "id": "0cb3e271-29a7-426c-8a20-20d627ada06b",
      "name": "Embeddings OpenAI",
      "credentials": {
        "openAiApi": {
          "id": "iN0WKiU3syo7QHmh",
          "name": "OpenAI Account"
        }
      }
    },
    {
      "parameters": {
        "content": "# Chatting",
        "height": 660,
        "width": 840,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1060,
        -100
      ],
      "typeVersion": 1,
      "id": "1d46da60-0847-489f-94db-8c3aa075886c",
      "name": "Sticky Note1"
    }
  ],
  "connections": {
    "Internal Data Agent": {
      "main": [
        []
      ]
    },
    "Chat": {
      "main": [
        [
          {
            "node": "Internal Data Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings Model": {
      "ai_embedding": [
        [
          {
            "node": "Pinecone Internal Data",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "4.1-mini": {
      "ai_languageModel": [
        [
          {
            "node": "Internal Data Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "List PDFs (Google Drive API)": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download PDF": {
      "main": [
        [
          {
            "node": "Pinecone Vector Store",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "Download PDF",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pinecone Internal Data": {
      "ai_tool": [
        [
          {
            "node": "Internal Data Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader": {
      "ai_document": [
        [
          {
            "node": "Pinecone Vector Store",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Text Splitter": {
      "ai_textSplitter": [
        [
          {
            "node": "Default Data Loader",
            "type": "ai_textSplitter",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI": {
      "ai_embedding": [
        [
          {
            "node": "Pinecone Vector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "instanceId": "e85ca3569654f8c99056066678f7f5d049e6b484d0e64e9cc65bf67d3d24ea18"
  }
}